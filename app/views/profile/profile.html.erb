<%= stylesheet_link_tag 'awesomplete', media: 'all' %>
<%= stylesheet_link_tag 'profile.css', media: 'all' %>
<%= javascript_include_tag 'awesomplete' %>

<% if @user.brand? %>
    <% title 'Brand Profile' %>
<% else %>
    <% title 'Influencer Profile' %>
<% end %>

<div class="brands-profile-page-wrapper">

  <%= render 'shared/show_errors', :object => @user%>
  <%= image_tag(@user.profile_picture(:thumb), :class => 'profile-picture center-block img-circle', :alt => 'profile-picture') %>

  <%= form_for @user, url: profile_path(@user), data: { parsley_validate: '' } , html: {class: 'form-horizontal personal-info-form'} do |f| %>

      <div class="personal-info-without-fb">

        <h4 class="personal-info">PERSONAL INFORMATION</h4>

        <div class="form-group">
          <div class="col-md-6">
            <%= f.label :first_name, 'First Name' %>
            <%= f.text_field :first_name, maxlength: 20, 'data-parsley-required' => 'true' %>
          </div>
          <div class="col-md-6">
            <%= f.label :last_name, 'Last Name' %>
            <%= f.text_field :last_name, maxlength: 20, 'data-parsley-required' => 'true' %>
          </div>
        </div>

        <div class="form-group">
          <div class="col-md-6">
            <%= f.label :company_name, 'Company Name' %>
            <%= f.text_field :company_name, maxlength: 50, 'data-parsley-required' => 'true' %>
          </div>
          <div class="col-md-6">
            <%= f.label :company_email, current_user.brand? ? 'Company Email' : 'Email' %>
            <%= f.email_field :company_email, maxlength: 50, 'data-parsley-required' => 'true', 'data-parsley-type' => 'email' %>
          </div>
        </div>

        <div class="form-group">
          <div class="col-md-6">
            <%= f.label :industry %>
            <%= f.text_field :industry, id: 'industry_list', maxlength: 100, 'data-parsley-required' => 'true' %>

          </div>
          <div class="col-md-6">
            <%= f.label :phone %>
            <%= f.text_field :phone, maxlength: 20, 'data-parsley-pattern' => '(^[\+]?[0-9]+[-]?[0-9]+[-]?[0-9]+$)', 'data-parsley-required' => 'true' %>
          </div>
        </div>

        <div class="form-group">
          <div class="col-md-6">
            <div>
              <%= f.label :street_address, class: 'textarea-label' %>
              <%= f.text_area :street_address, rows: 4, class: 'street-address-textarea',
                              placeholder: 'Enter your address here', maxlength: 200, 'data-parsley-required' => 'true' %>
            </div>
            <div>
              <%= f.label :zip_code %>
              <%= f.text_field :zip_code, maxlength: 20, 'data-parsley-required' => 'true' %>
            </div>
          </div>

          <div class="col-md-6">
            <div class="row">
              <div class="col-md-12">
                <%= f.label :landmark %>
                <%= f.text_field :landmark, maxlength: 100 %>
              </div>
              <div class="col-md-12">
                <%= f.label :city %>
                <%= f.text_field :city, maxlength: 50, 'data-parsley-required' => 'true' %>
              </div>
              <div class="col-md-12">
                <%= f.label :country %>
                <%= f.country_select :country, {priority: %w(US CA IN)}, {:class => 'profile-dropdown-color'}, {} %>
              </div>
              <div class="col-md-12">
                <%= f.label :state %>
                <%= render partial: 'shared/sub_region_select', locals: { parent_region: f.object.country } %>
              </div>
            </div>
          </div>
        </div>

        <% unless current_user.provider? || current_user.uid? %>
            <div class="divider-personal-info-password"></div>

            <h4 class="account-setup">ACCOUNT SETUP</h4>

            <div class="form-group">
              <div class="col-md-6">
                <%= f.label :current_password, 'Old Password' %>
                <%= f.password_field :current_password %>
              </div>
              <div class="col-md-6">
                <label>&nbsp;</label>
              </div>
            </div>

            <div class="form-group">
              <div class="col-md-6">
                <%= f.label :password, 'New Password' %>
                <%= f.password_field :password %>
              </div>
              <div class="col-md-6">
                <%= f.label :password_confirmation, 'Retype Password' %>
                <%= f.password_field :password_confirmation %>
              </div>
            </div>
        <% end %>

        <h4 class="company-info">
          <%= @user.influencer? ? 'PROFESSIONAL INFORMATION' : 'COMPANY INFORMATION' %>
        </h4>

        <div class="form-group short-bio-row">
          <div class="col-md-12">
            <%= f.label :short_bio, 'Short Bio', class: 'textarea-label' %>
            <%= f.text_area :short_bio, rows: 8, class: 'short_bio', maxlength: '1000', 'data-parsley-required' => 'true' %>
          </div>
        </div>
      </div>

      <% if @user.influencer? %>
          <h4 class="social-account">SOCIAL ACCOUNTS AND PRICING</h4>

          <button type="button" class="btn btn-account button-border-yellow" data-trigger="modal" data-target="AddFacebookAccount" href="javascript:" data-dismiss="modal">MANAGE ACCOUNT</button>

          <%= render partial: 'shared/add_account_modal' %>

          <div class="social-account-tabs">
            <%= render partial: 'social_account_tabs', locals: { f: f } %>
          </div>
      <% end %>

      <%#= render partial: 'shared/profile_image_upload', locals: { user: current_user } %>
      </div>
      <%= f.button 'UPDATE', class: 'btn btn-update button-border-yellow' %>
  <% end %>

  <script>
      $(document).ready(function () {
          var industry_list = document.getElementById("industry_list");
          var Industries = new Awesomplete(industry_list, {minChars: 0, sort: String.localeCompare, filter: Awesomplete.FILTER_STARTSWITH});
          Industries.list = <%= raw(@industries) %>;

          $('#industry_list').on('focus', function() {
              Industries.evaluate();
          });
      });

  </script>

