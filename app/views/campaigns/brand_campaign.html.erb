<%= stylesheet_link_tag 'campaigns.css', media: 'all' %>
<%= stylesheet_link_tag 'jquery-jvectormap-1.2.2', media: 'all' %>

<% title 'Brand Campaign' %>

<section class="influence-facebook-content">
  <div class="row campaign-view">
    <%= form_tag(nil, method: 'get') do %>
        <%= label_tag :name, 'Choose a Campaign' %>
        <%= select_tag 'id', options_from_collection_for_select(@campaigns, 'id', 'name', @campaign.id), prompt: 'Choose a campaign to view the statistics', id: 'campaign_id'%>
        <%= button_tag 'VIEW', class: 'btn btn-campaign-view' %>
    <% end %>
  </div>
  <div class="br-container">
    <!-- Info boxes -->

    <div class="row download-campaign">
      <%= link_to "DOWNLOAD THIS CAMPAIGN'S REPORT", '#', :class => 'btn btn-download-campaign', id: 'download_campaigns' %>
    </div>

    <div class="row info-box-container">
      <div class="info-box-custom col-md-3 col-sm-6 col-xs-6">
        <div class="info-box-content">
          <p class="info-box-data total-follower-data-color"><%= number_with_delimiter(@campaign.number_of_likes) %></p>
          <p class="info-box-text ">LIKES</p>
        </div>
      </div>

      <div class="info-box-custom col-md-3 col-sm-6 col-xs-6">
        <div class="info-box-content">
          <p class="info-box-data page-view-data-color"><%= number_with_delimiter(@campaign.number_of_post_reach) %></p>
          <p class="info-box-text">POST REACH</p>
        </div>
      </div>

      <!-- fix for small devices only -->
      <div class="clearfix visible-sm-block"></div>
      <div class="clearfix visible-xs-block"></div>

      <div class="info-box-custom col-md-3 col-sm-6 col-xs-6">
        <div class="info-box-content">
          <p class="info-box-data total-post-data-color"><%= number_with_delimiter(@campaign.number_of_comments) %></p>
          <p class="info-box-text">COMMENTS</p>
        </div>
      </div>

      <div class="info-box-custom col-md-3 col-sm-6 col-xs-6">
        <div class="info-box-content">
          <p class="info-box-data post-reach-data-color"><%= number_with_delimiter(@campaign.number_of_shares) %></p>
          <p class="info-box-text">SHARES</p>
        </div>
      </div>
    </div>

    <div class="campaign-content brand-campaign-content">

      <ul class="nav nav-tabs campaign-nav-tabs" id="campaign-tabs">
        <li class= "active" id="performance_list"><a href="#performance"><span id="performance-blue"><%= image_tag('Performance_blue.png') %></span><span id="performance-black" class="display-none"><%= image_tag('Performance.png') %></span> <span class="performance-tab"></span> Performance </a></li>
        <li class= "" id="engagement_list"><a href="#engagement"><span id="engagement-black"><%= image_tag('Engagement_black.png') %></span><span id="engagement-blue" class="display-none"><%= image_tag('Engagement.png') %></span><span class="engagement-tab"></span> Engagement </a></li>
      </ul>

      <div class="tab-content panel panel-campaigns">
        <div id="performance" class="tab-pane fade in active">
          <table class="table table-striped table-bordered table-responsive brand_campaign_performance_table">

            <thead>
            <tr class="payment-header">
              <th>Campaign Name</th>
              <th>Post Likes</th>
              <th>Reach</th>
            </tr>
            </thead>

            <tbody>
            <tr>
              <td><%= image_tag(@campaign.receiver.profile_picture, :class => 'pepsi-img-responsive') %> &nbsp; <%= @campaign.name %></td>
              <td><%= @campaign.number_of_likes %></td>
              <td><%= @campaign.number_of_post_reach %></td>
            </tr>
            </tbody>

          </table>
        </div>

        <div id="engagement" class="tab-pane fade">
          <table class="table table-striped table-bordered table-responsive brand_campaign_engagement_table">

            <thead>
            <tr class="payment-header">
              <th>Campaign Name</th>
              <th>Likes</th>
              <th>Comments</th>
              <th>Shares</th>
            </tr>
            </thead>

            <tbody>
            <tr>
              <td><%= image_tag(@campaign.receiver.profile_picture, :class => 'pepsi-img-responsive') %> &nbsp; <%= @campaign.name %></td>
              <td><%= @campaign.number_of_likes %></td>
              <td><%= @campaign.number_of_comments %></td>
              <td><%= @campaign.number_of_shares %></td>
            </tr>
            </tbody>

          </table>
        </div>
      </div>
    </div>
  </div>
</section>

<script type="text/javascript">
    $(document).ready(function(){

        $("#campaign-tabs a").click(function(e){
            e.preventDefault();
            $(this).tab('show');
        });

        $(document).on('click','#engagement_list',function(){
            document.getElementById("performance-blue").style.display = 'none';
            document.getElementById("performance-black").style.display = 'inline';
            document.getElementById("engagement-black").style.display = 'none';
            document.getElementById("engagement-blue").style.display = 'inline';
        });

        $(document).on('click','#performance_list',function(){
            document.getElementById("performance-black").style.display = 'none';
            document.getElementById("performance-blue").style.display = 'inline';
            document.getElementById("engagement-blue").style.display = 'none';
            document.getElementById("engagement-black").style.display = 'inline';
        });

        $('#download_campaigns').click(function() {
            var campaign_id = $('#campaign_id option:selected').val();

            window.location.href = "<%= export_campaigns_path(format: :csv) %>?campaign_id=" + campaign_id;
        });

    });
</script>

